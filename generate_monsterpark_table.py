import matplotlib.pyplot as plt
import pandas as pd

# 데이터 설정 (유저가 제공한 이미지 기반)
# 구간 1: Lv. 260 ~ 279
data1 = {
    '레벨': list(range(260, 280)),
    '리멘': [
        '0.898%', '0.889%', '0.880%', '0.872%', '0.863%',
        '0.664%', '0.657%', '0.651%', '0.644%', '0.638%',
        '0.287%', '0.285%', '0.282%', '0.279%', '0.276%',
        '0.137%', '0.124%', '0.113%', '0.103%', '0.093%'
    ],
    '세르니움': [
        '2.164%', '2.142%', '2.121%', '2.100%', '2.079%',
        '1.599%', '1.584%', '1.568%', '1.552%', '1.537%',
        '0.692%', '0.686%', '0.679%', '0.672%', '0.665%',
        '0.329%', '0.299%', '0.272%', '0.247%', '0.225%'
    ],
    '아르크스': [
        '-', '-', '-', '-', '-',
        '1.897%', '1.878%', '1.859%', '1.841%', '1.823%',
        '0.821%', '0.813%', '0.805%', '0.797%', '0.789%',
        '0.391%', '0.355%', '0.323%', '0.293%', '0.267%'
    ],
    '오디움': [
        '-', '-', '-', '-', '-',
        '-', '-', '-', '-', '-',
        '0.976%', '0.966%', '0.957%', '0.947%', '0.938%',
        '0.464%', '0.422%', '0.384%', '0.349%', '0.317%'
    ],
    '도원경': [
        '-', '-', '-', '-', '-',
        '-', '-', '-', '-', '-',
        '-', '-', '-', '-', '-',
        '0.674%', '0.612%', '0.557%', '0.506%', '0.460%'
    ]
}

# 구간 2: Lv. 280 ~ 299 (유효 사냥터 위주 기입)
data2 = {
    '레벨': list(range(280, 300)),
    '도원경': [
        '0.228%', '0.207%', '0.188%', '0.171%', '0.156%',
        '0.077%', '0.070%', '0.064%', '0.058%', '0.053%',
        '0.026%', '0.024%', '0.022%', '0.020%', '0.018%',
        '0.009%', '0.008%', '0.007%', '0.007%', '0.004%'
    ],
    '아르테리아': [
        '0.319%', '0.290%', '0.263%', '0.239%', '0.218%',
        '0.108%', '0.098%', '0.089%', '0.081%', '0.074%',
        '0.036%', '0.033%', '0.030%', '0.027%', '0.025%',
        '0.012%', '0.011%', '0.010%', '0.009%', '0.006%'
    ],
    '카르시온': [
        '-', '-', '-', '-', '-',
        '0.157%', '0.143%', '0.130%', '0.118%', '0.107%',
        '0.053%', '0.048%', '0.044%', '0.040%', '0.036%',
        '0.018%', '0.016%', '0.015%', '0.013%', '0.009%'
    ],
    '탈라하트': [
        '-', '-', '-', '-', '-',
        '-', '-', '-', '-', '-',
        '0.074%', '0.068%', '0.061%', '0.056%', '0.051%',
        '0.025%', '0.023%', '0.021%', '0.019%', '0.013%'
    ]
}

df1 = pd.DataFrame(data1)
df2 = pd.DataFrame(data2)

# 이미지 생성 설정
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(20, 12))  # 가로로 두 개 배치
fig.patch.set_facecolor('#FFFFFF')

# 한글 폰트 설정 (시스템에 따라 다를 수 있으므로 기본 sans-serif 사용하되 최대한 깔끔하게)
plt.rcParams['font.family'] = 'sans-serif'

# 색상 설정
header_color = '#FFD700' # 노란색
cell_base_color = '#FFFFFF' # 흰색
text_color = '#000000'

def draw_table(ax, df, title):
    ax.axis('off')
    ax.axis('tight')
    
    # 테이블 그리기
    table = ax.table(cellText=df.values, colLabels=df.columns, loc='center', cellLoc='center')
    
    # 스타일링
    table.auto_set_font_size(False)
    table.set_fontsize(11)
    table.scale(1.2, 1.8) # 셀 크기 조절

    # 셀 스타일 적용
    for (row, col), cell in table.get_celld().items():
        cell.set_edgecolor('black')
        cell.set_linewidth(0.5)
        
        if row == 0:
            cell.set_facecolor(header_color)
            cell.set_text_props(weight='bold', color='black')
            cell.set_height(0.06)
        else:
            # 줄무늬 효과 (선택사항) 또는 특정 조건 강조
            cell.set_facecolor(cell_base_color)
            # 데이터가 '-' 인 경우 회색 처리 (시각적 구분)
            if cell.get_text().get_text() == '-':
                cell.set_facecolor('#F0F0F0') # 연한 회색
                cell.set_text_props(color='#999999')
            # 레벨 컬럼 강조
            if col == 0:
                cell.set_facecolor('#EFEFEF')
                cell.set_text_props(weight='bold')
    
    ax.set_title(title, fontsize=16, weight='bold', pad=20)

draw_table(ax1, df1, "Lv. 260 ~ 279 몬스터파크 경험치 획득률")
draw_table(ax2, df2, "Lv. 280 ~ 299 몬스터파크 경험치 획득률 (주요 지역)")

plt.tight_layout()
plt.savefig('monster_park_exp_table.png', dpi=150, bbox_inches='tight')
print("이미지 생성 완료: monster_park_exp_table.png")
